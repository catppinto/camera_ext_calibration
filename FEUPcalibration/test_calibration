w = [0.7005 0.024 0; ... 
   0.4 0.024 0 ; ...
   0.2495 0.024 0; ...
   0.402 0.19 0; ...
   0.449 -0.004 0.16627; ...
   0.449 -0.004 0.11877; ...
   0.449 -0.004 0.07127; ...
   0.449 -0.004 0.02377];

ctag = [-0.322713 0.0119508 0.671776; ...
    0.0577349 0.0274597 0.670989; ...
    0.243119 0.0353418 0.669769; ...
    0.053183 0.158643 0.511146; ...
    0.0110721 -0.161089 0.57441; ...
    0.00809416 -0.114525 0.611413; ...
    0.00515552 -0.0678623 0.646763; ...
    0.00249965 -0.0216926 0.685821];

%%
x = w - repmat(mean(w), size(w,1), 1) ; 
y = ctag - repmat(mean(ctag), size(ctag,1), 1);
scatter3(x(:, 1), x(:, 2), x(:, 3), 'r');
hold on;
scatter3(y(:, 1), y(:, 2), y(:, 3), 'g');

%% 
H = zeros(3,3);
for i=1:8
    ww =  x(i, :)';
    cc =  y(i, :)';
    H = H + (ww * cc');
end

[U, S, V] = svd(H); 

vut = V*U';
d = sign(det(vut)); 
R = V * [1 0 0 ; 0 1 0; 0 0 d] * U'

T = - R * mean(w)' + mean(ctag)'


%%

ww1 = R * x(0)
        
   