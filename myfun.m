function [F, J] = myfun(x, xdata)

K = [529.2945040622658, 0.0, 466.96044871160075, 0.0 ; ...
    0.0, 531.2834529497384, 273.2593671723483 , 0.0 ; ...
    0.0, 0.0, 1.0, 0.0;
    0.0, 0.0, 0.0, 1.0];

% convert the 3-vector [wx wy wz] of the Rodrigues representation
% into the 3x3 rotation matrix
theta2=x(1)^2+x(2)^2+x(3)^2;
theta=sqrt(theta2);
omega=[0 -x(3) x(2);
    x(3) 0  -x(1);
    -x(2) x(1) 0;];
R = eye(3) + (sin(theta)/theta)*omega + ((1-cos(theta))/(theta^2))*(omega*omega);
t=[x(4);x(5);x(6)];

uv = K * [R t ; 0 0 0 1] * xdata;
up = uv(1,:)./uv(3,:);
vp = uv(2,:)./uv(3,:);
F = [up; vp];

if nargout > 1   % two output arguments
    wx = x(1); wy = x(2); wz = x(3); tx = x(4); ty = x(5); tz = x(6);
    au = K(1,1); av = K(2,2); u0 = K(1,3); v0 = K(2,3);
 
	for i= 1:size(xdata, 2)
        X = xdata(1,i); 
        Y = xdata(2,i); 
        Z = xdata(3,i); 

        J(2*(i-1)+1,:)=[ (X*(au*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - u0*((wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)) - Y*(au*((wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx^2*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + u0*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + Z*(u0*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - au*((wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wx^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((X*((wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + Y*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2)))*(au*tx - Y*(au*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - u0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*u0 - X*(u0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - au*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) + Z*(au*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + u0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, (X*(au*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - u0*((wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + Z*(u0*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - au*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wy^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) - Y*(au*((wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + u0*((wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((Y*((wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + X*((wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2)))*(au*tx - Y*(au*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - u0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*u0 - X*(u0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - au*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) + Z*(au*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + u0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, (Z*(u0*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - au*((wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wx*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)) - Y*(u0*((wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + au*((wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wz^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + X*(au*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - u0*((wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((X*((wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + Y*((wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2))*(au*tx - Y*(au*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - u0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*u0 - X*(u0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - au*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) + Z*(au*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + u0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, -au/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)), 0, (au*tx - Y*(au*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - u0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*u0 - X*(u0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - au*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wy^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) + Z*(au*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + u0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2 - u0/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))];
        J(2*(i-1)+2,:)= [ (Y*(av*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - v0*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + Z*(v0*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - av*((wx^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) - X*(av*((wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wx^2*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + v0*((wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((X*((wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + Y*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2)))*(av*ty + X*(av*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*v0 + Y*(v0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + av*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) - Z*(av*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, (Y*(av*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - v0*((wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)) - X*(av*((wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wx*wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + v0*((wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + Z*(v0*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - av*((wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((Y*((wx*wy*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy^2*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy^2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + X*((wy^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2)))*(av*ty + X*(av*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*v0 + Y*(v0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + av*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) - Z*(av*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, (Z*(v0*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - av*((wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wy*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)) - X*(v0*((wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) + av*(sin((wx^2 + wy^2 + wz^2)^(1/2))/(wx^2 + wy^2 + wz^2)^(1/2) + (wz^2*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2 + (wx*wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2))) + Y*(av*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^2 - (2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2)^(3/2)) - v0*((wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)) + ((X*((wy*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) - (wy*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wx*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) + (wx*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wx*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2) - Z*((2*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^2 + (wz*sin((wx^2 + wy^2 + wz^2)^(1/2))*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2)^(3/2)) + Y*((wx*wz*cos((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2) - (wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2) - (wx*wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (wy*wz^2*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(3/2) + (2*wy*wz^2*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)^2))*(av*ty + X*(av*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*v0 + Y*(v0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + av*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) - Z*(av*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2, 0, -av/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)), (av*ty + X*(av*((wz*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wx*wy*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2))) + tz*v0 + Y*(v0*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + av*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wz^2))/(wx^2 + wy^2 + wz^2) + 1)) - Z*(av*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) - v0*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1)))/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))^2 - v0/(tz - X*((wy*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) + (wx*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Y*((wx*sin((wx^2 + wy^2 + wz^2)^(1/2)))/(wx^2 + wy^2 + wz^2)^(1/2) - (wy*wz*(cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1))/(wx^2 + wy^2 + wz^2)) + Z*(((cos((wx^2 + wy^2 + wz^2)^(1/2)) - 1)*(wx^2 + wy^2))/(wx^2 + wy^2 + wz^2) + 1))];
    end
end
